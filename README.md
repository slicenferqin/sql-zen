# SQL-Zen

> Less Tools, More Intelligence

**SQL-Zen** æ˜¯ä¸€ä¸ªæç®€ä¸»ä¹‰çš„ Text-to-SQL Agentï¼Œè®©ä½ ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ•°æ®åº“ã€‚

å— [Vercel d0 é¡¹ç›®](./docs/references/vercel-blog-we-removed-80-percent-of-our-agents-tools.md) å¯å‘ï¼Œæˆ‘ä»¬é‡‡ç”¨"æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨"çš„æ¶æ„ï¼š**åªç”¨ 2 ä¸ªå·¥å…·ï¼Œæ›¿ä»£ä¼ ç»Ÿæ–¹æ¡ˆçš„ 15+ ä¸ªå·¥å…·**ï¼Œåè€Œè·å¾—æ›´å¥½çš„æ•ˆæœã€‚

## Why SQL-Zen?

ä¼ ç»Ÿ Text-to-SQL æ–¹æ¡ˆçš„é—®é¢˜ï¼š

| é—®é¢˜ | ä¼ ç»Ÿæ–¹æ¡ˆ | SQL-Zen |
|------|----------|---------|
| å·¥å…·æ•°é‡ | 15+ ä¸ªä¸“ç”¨å·¥å…· | **2 ä¸ª** |
| æ¶æ„å¤æ‚åº¦ | å¤æ‚çš„ RAG + å¤šè½®éªŒè¯ | **æ–‡ä»¶ç³»ç»Ÿ + LLM** |
| ç»´æŠ¤æˆæœ¬ | æ¯ä¸ªè¾¹ç•Œæƒ…å†µéƒ½è¦æ‰“è¡¥ä¸ | **è®©æ¨¡å‹è‡ªå·±å¤„ç†** |
| æ¨¡å‹ä¾èµ– | æ¯æ¬¡æ›´æ–°éƒ½è¦é‡æ–°è°ƒæ•´ | **ä¿¡ä»»æ¨¡å‹æ¨ç†èƒ½åŠ›** |

**æ ¸å¿ƒç†å¿µ**ï¼šä¸è¦æ›¿æ¨¡å‹æ€è€ƒï¼Œç»™å®ƒå¥½çš„ä¸Šä¸‹æ–‡ï¼Œè®©å®ƒè‡ªå·±æ¢ç´¢ã€‚

## ä¸ä¸»æµæ–¹æ¡ˆå¯¹æ¯”

æˆ‘ä»¬è°ƒç ”äº† 8 ä¸ªä¸»æµçš„å¼€æº Text-to-SQL æ–¹æ¡ˆï¼ˆVanna AI, DB-GPT, SQLCoder, Langchain ç­‰ï¼‰ï¼Œå‘ç°å®ƒä»¬éƒ½å­˜åœ¨ç›¸ä¼¼çš„é—®é¢˜ï¼š

| å¯¹æ¯”ç»´åº¦ | ä¸»æµæ–¹æ¡ˆ | SQL-Zen | ä¼˜åŠ¿ |
|---------|---------|---------|------|
| **å·¥å…·æ•°é‡** | 10-20 ä¸ªä¸“ç”¨å·¥å…· | **2 ä¸ª** | å‡å°‘ 87% çš„å·¥å…·ï¼Œé™ä½å¤æ‚åº¦ |
| **æ¶æ„** | RAG + å‘é‡æ•°æ®åº“ + Multi-Agent | **æ–‡ä»¶ç³»ç»Ÿ + LLM** | æ— éœ€é¢å¤–ä¾èµ–ï¼Œç»´æŠ¤æˆæœ¬æä½ |
| **Schema ç®¡ç†** | æ•°æ®åº“è‡ªåŠ¨æå– + å‘é‡æ£€ç´¢ | **YAML æ–‡ä»¶ + grep/cat/ls** | ç‰ˆæœ¬æ§åˆ¶å‹å¥½ï¼Œæ–‡æ¡£å³ä»£ç  |
| **å­¦ä¹ æ›²çº¿** | é™¡å³­ï¼ˆéœ€ç†è§£ RAGã€å‘é‡æ•°æ®åº“ç­‰ï¼‰ | **å¹³ç¼“**ï¼ˆç†Ÿæ‚‰çš„ Unix å·¥å…·ï¼‰ | å¼€å‘è€…å‹å¥½ |
| **Token æ•ˆç‡** | å·¥å…·å®šä¹‰å ç”¨å¤§é‡ token | **é«˜æ•ˆ**ï¼ˆç®€å•å·¥å…·å®šä¹‰ï¼‰ | é¢„è®¡å‡å°‘ 30-40% token æ¶ˆè€— |
| **çµæ´»æ€§** | å—å·¥å…·é™åˆ¶ï¼Œéœ€ä¸ºè¾¹ç•Œæƒ…å†µæ‰“è¡¥ä¸ | **æ¨¡å‹è‡ªç”±æ¨ç†** | ä¿¡ä»» LLM èƒ½åŠ›ï¼Œé€‚åº”æ€§å¼º |

### æˆ‘ä»¬çš„å·®å¼‚åŒ–ä¼˜åŠ¿

1. **æç®€ä¸»ä¹‰** - ç”¨ Unix å“²å­¦é‡æ–°æ€è€ƒ Text-to-SQLï¼Œè¯æ˜"Less Tools, More Intelligence"
2. **æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨** - åˆ©ç”¨ 50 å¹´å†å²çš„ grep/cat/lsï¼Œæ— éœ€å­¦ä¹ æ–°å·¥å…·
3. **é«˜è´¨é‡æ–‡æ¡£** - å¼ºåˆ¶è¦æ±‚è¯¦ç»†çš„ YAML Schemaï¼Œæ–‡æ¡£è´¨é‡ > å·¥å…·æ•°é‡
4. **ä¸ºæœªæ¥æ„å»º** - ä¸ä¸ºå½“å‰æ¨¡å‹çš„å±€é™æ€§æ‰“è¡¥ä¸ï¼Œä¸ºæ›´å¼ºçš„æ¨¡å‹æ„å»ºåŸºç¡€è®¾æ–½

ğŸ“Š **è¯¦ç»†å¯¹æ¯”åˆ†æ**: æŸ¥çœ‹å®Œæ•´çš„ [Text-to-SQL æ–¹æ¡ˆè°ƒç ”æŠ¥å‘Š](./docs/research-text-to-sql-solutions.md)ï¼Œäº†è§£æˆ‘ä»¬å¦‚ä½•åœ¨ 8 ä¸ªä¸»æµæ–¹æ¡ˆä¸­æ‰¾åˆ°å·®å¼‚åŒ–å®šä½ã€‚

## Quick Start

```bash
# å®‰è£…
npm install -g sql-zen

# åˆå§‹åŒ–é¡¹ç›®ï¼ˆç”Ÿæˆ schema ç›®å½•ï¼‰
sql-zen init

# é…ç½®æ•°æ®åº“è¿æ¥
export DATABASE_URL="postgresql://user:pass@localhost:5432/mydb"

# å¼€å§‹æé—®
sql-zen ask "ä¸Šä¸ªæœˆé”€å”®é¢æœ€é«˜çš„ 10 ä¸ªäº§å“æ˜¯ä»€ä¹ˆï¼Ÿ"
```

## How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "ä¸Šä¸ªæœˆé”€å”®é¢æœ€é«˜çš„ 10 ä¸ªäº§å“æ˜¯ä»€ä¹ˆï¼Ÿ"                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LLM Agent                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  execute_bash  â”‚    â”‚  execute_sql   â”‚                â”‚
â”‚  â”‚  grep/cat/ls   â”‚    â”‚  è¿è¡Œ SQL      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                     â”‚
           â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Schema æ–‡ä»¶ç³»ç»Ÿ  â”‚    â”‚     æ•°æ®åº“       â”‚
â”‚  (YAML/Markdown) â”‚    â”‚  (PostgreSQL)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Agent çš„å·¥ä½œæµç¨‹**ï¼š

1. æ”¶åˆ°ç”¨æˆ·é—®é¢˜
2. ç”¨ `ls` æŸ¥çœ‹ schema ç›®å½•ç»“æ„
3. ç”¨ `cat` è¯»å–ç›¸å…³è¡¨å®šä¹‰
4. ç”¨ `grep` æœç´¢å…³è”å…³ç³»
5. ç”Ÿæˆ SQL å¹¶ç”¨ `execute_sql` æ‰§è¡Œ
6. è¿”å›ç»“æœå’Œè§£é‡Š

## Schema æ–‡ä»¶ç»“æ„

SQL-Zen çš„æ ¸å¿ƒæ˜¯é«˜è´¨é‡çš„ Schema æ–‡æ¡£ï¼š

```
schema/
â”œâ”€â”€ tables/              # è¡¨å®šä¹‰
â”‚   â”œâ”€â”€ orders.yaml
â”‚   â”œâ”€â”€ users.yaml
â”‚   â””â”€â”€ products.yaml
â”œâ”€â”€ joins/               # å…³è”å…³ç³»
â”‚   â””â”€â”€ relationships.yaml
â”œâ”€â”€ measures/            # å¸¸ç”¨åº¦é‡
â”‚   â””â”€â”€ metrics.yaml
â”œâ”€â”€ examples/            # ç¤ºä¾‹ SQL
â”‚   â””â”€â”€ common_queries.sql
â””â”€â”€ README.md            # Schema æ¦‚è§ˆ
```

**è¡¨å®šä¹‰ç¤ºä¾‹** (`schema/tables/orders.yaml`)ï¼š

```yaml
table:
  name: orders
  description: "è®¢å•ä¸»è¡¨ï¼Œè®°å½•æ‰€æœ‰ç”¨æˆ·è®¢å•ä¿¡æ¯"
  
columns:
  - name: order_id
    type: string
    description: "è®¢å•å”¯ä¸€æ ‡è¯†"
    primary_key: true
    
  - name: user_id
    type: string
    description: "ç”¨æˆ·IDï¼Œå…³è” users è¡¨"
    foreign_key: users.user_id
    
  - name: total_amount
    type: decimal
    description: "è®¢å•æ€»é‡‘é¢ï¼ˆå•ä½ï¼šå…ƒï¼‰"
    
  - name: status
    type: string
    description: "è®¢å•çŠ¶æ€"
    enum: [pending, paid, shipped, completed, cancelled]
```

## Features

### å·²å®ç°

- [x] CLI å·¥å…· (`sql-zen init`, `sql-zen ask`, `sql-zen validate`)
- [x] PostgreSQL æ”¯æŒ
- [x] MySQL æ”¯æŒ
- [x] SQLite æ”¯æŒ
- [x] YAML Schema è§£æ
- [x] Claude API é›†æˆ
- [x] execute_bash å·¥å…·å®ç°
- [x] execute_sql å·¥å…·å®ç°
- [x] Agent Skills é›†æˆï¼ˆ3 ä¸ªæ ¸å¿ƒ Skills + Schema æ–‡æ¡£ï¼‰
- [x] å®Œæ•´çš„ Schema è®¾è®¡æŒ‡å—æ–‡æ¡£

### è®¡åˆ’ä¸­

- [ ] å¤šæ¨¡å‹æ”¯æŒ (GPT-4, Ollama)
- [ ] äº¤äº’å¼ REPL æ¨¡å¼
- [ ] Web UI
- [ ] Slack Bot é›†æˆ
- [ ] Schema è‡ªåŠ¨ç”Ÿæˆ (`sql-zen schema import`)
- [ ] å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

æŸ¥çœ‹å®Œæ•´ [Roadmap](./docs/roadmap.md)

## Configuration

```bash
# å¿…éœ€ï¼šLLM API Key
export ANTHROPIC_API_KEY="sk-ant-..."

# å¿…éœ€ï¼šæ•°æ®åº“è¿æ¥ï¼ˆæ ¹æ®æ•°æ®åº“ç±»å‹é€‰æ‹©ï¼‰

# PostgreSQL
export DATABASE_TYPE="postgresql"
export DATABASE_URL="postgresql://user:pass@localhost:5432/mydb"

# MySQL
export DATABASE_TYPE="mysql"
export DATABASE_URL="mysql://user:pass@localhost:3306/mydb"

# SQLite
export DATABASE_TYPE="sqlite"
export DATABASE_URL="/path/to/database.db"

# å¯é€‰ï¼šæ¨¡å‹é€‰æ‹©ï¼ˆé»˜è®¤ claude-sonnet-4-20250514ï¼‰
export SQL_ZEN_MODEL="claude-sonnet-4-20250514"
```

## Documentation

### æ ¸å¿ƒæ–‡æ¡£

- [è®¾è®¡æ–‡æ¡£](./docs/design.md) - æ¶æ„è®¾è®¡å’ŒæŠ€æœ¯å†³ç­–
- [è°ƒç ”æŠ¥å‘Š](./docs/research-text-to-sql-solutions.md) - ä¸»æµæ–¹æ¡ˆå¯¹æ¯”åˆ†æ
- [Roadmap](./docs/roadmap.md) - ç‰ˆæœ¬è§„åˆ’å’Œè¿­ä»£è®¡åˆ’
- [å¼€å‘è€…æŒ‡å—](./AGENTS.md) - AI Agent å¼€å‘æŒ‡å—
- [Vercel åšå®¢å‚è€ƒ](./docs/references/vercel-blog-we-removed-80-percent-of-our-agents-tools.md) - çµæ„Ÿæ¥æº

### Schema è®¾è®¡æŒ‡å—

- [Schema README](./schema/README.md) - Schema ç›®å½•æ¦‚è§ˆ
- [Schema è®¾è®¡æ–¹æ³•è®º](./schema/guides/schema-methodology.md) - è®¾è®¡åŸåˆ™å’Œæœ€ä½³å®è·µ
- [è¡¨è®¾è®¡ç¤ºä¾‹](./schema/guides/table-design.md) - å®Œæ•´çš„è¡¨å®šä¹‰ç¤ºä¾‹
- [åˆ—å‘½åè§„èŒƒ](./schema/guides/column-naming.md) - å‘½åè§„èŒƒå’Œçº¦å®š
- [å…³ç³»è®¾è®¡æ¨¡å¼](./schema/guides/relationship-design.md) - è¡¨é—´å…³ç³»å»ºæ¨¡
- [SQL æœ€ä½³å®è·µ](./schema/guides/sql-best-practices.md) - æŸ¥è¯¢ä¼˜åŒ–å’Œè§„èŒƒ

### Agent Skills

- [sql-zen-explore](./agentskills/sql-zen-explore.md) - ç³»ç»ŸåŒ–æ¢ç´¢ Schema
- [sql-zen-query](./agentskills/sql-zen-query.md) - é«˜è´¨é‡ SQL ç”Ÿæˆ
- [sql-zen-analyze](./agentskills/sql-zen-analyze.md) - æ•°æ®åˆ†ææ´å¯Ÿ

## Philosophy

> "The best agents might be the ones with the fewest tools."
> â€” Vercel Engineering

æˆ‘ä»¬ç›¸ä¿¡ï¼š

1. **æ–‡ä»¶ç³»ç»Ÿæ˜¯æœ€å¥½çš„æŠ½è±¡** - grep å·²ç» 50 å¹´äº†ï¼Œä¾ç„¶å¥½ç”¨
2. **ä¿¡ä»»æ¨¡å‹çš„æ¨ç†èƒ½åŠ›** - ä¸è¦è¿‡åº¦çº¦æŸ
3. **æ–‡æ¡£è´¨é‡ > å·¥å…·æ•°é‡** - å¥½çš„ Schema æ–‡æ¡£æ˜¯æˆåŠŸçš„åŸºç¡€
4. **ä¸ºæœªæ¥çš„æ¨¡å‹æ„å»º** - æ¨¡å‹è¿›æ­¥æ¯”å·¥å…·è¿­ä»£æ›´å¿«

## Contributing

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [Contributing Guide](./CONTRIBUTING.md)ï¼ˆå³å°†æ¨å‡ºï¼‰

## License

MIT

---

**Inspired by [Vercel's d0](https://vercel.com/blog/we-removed-80-percent-of-our-agents-tools)** - æ„Ÿè°¢ä»–ä»¬åˆ†äº«è¿™ä¸ªæç®€ä½†å¼ºå¤§çš„æ¶æ„ç†å¿µã€‚
